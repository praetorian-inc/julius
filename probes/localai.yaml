# probes/localai.yaml
# Reference: https://localai.io/features/openai-functions/
name: localai
description: LocalAI - local OpenAI compatible API
category: self-hosted
port_hint: 8080
specificity: 75
api_docs: https://localai.io/api/

requests:
  # LocalAI-specific: metrics endpoint with LocalAI markers
  - type: http
    path: /metrics
    method: GET
    match:
      - type: status
        value: 200
      - type: body.contains
        value: "# HELP"
      - type: body.contains
        value: "# TYPE"
      - type: body.contains
        value: "LocalAI"
    confidence: high

  # LocalAI-specific: metrics with localai_ prefix
  - type: http
    path: /metrics
    method: GET
    match:
      - type: status
        value: 200
      - type: body.contains
        value: "localai_"
    confidence: high

models:
  path: /v1/models
  method: GET
  extract: ".data[].id"

augustus:
  generator: openai
  config_template:
    endpoint: "$TARGET/v1"
    model: "$MODEL"
    api_key: "not-needed"
    timeout: 180
