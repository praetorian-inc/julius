# probes/nvidia-nim.yaml
# Reference: https://docs.nvidia.com/nim/large-language-models/latest/api-reference.html
name: nvidia-nim
description: NVIDIA NIM enterprise containers
category: self-hosted
port_hint: 8000
specificity: 75
api_docs: https://docs.nvidia.com/nim/large-language-models/latest/api-reference.html

requests:
  - type: http
    path: /v1/metadata
    method: GET
    match:
      - type: status
        value: 200
      - type: body.contains
        value: '"modelInfo"'
      - type: body.contains
        not: true
        value: "<!DOCTYPE"
      - type: body.contains
        not: true
        value: "<html"

  - type: http
    path: /v1/metadata
    method: GET
    match:
      - type: status
        value: 200
      - type: body.contains
        value: '"assetInfo"'
      - type: body.contains
        value: '"version"'
      - type: body.contains
        not: true
        value: "<!DOCTYPE"
      - type: body.contains
        not: true
        value: "<html"

  - type: http
    path: /v1/health/ready
    method: GET
    match:
      - type: status
        value: 200
      - type: body.contains
        value: '"status"'
      - type: body.contains
        value: "ready"
      - type: body.contains
        not: true
        value: "<!DOCTYPE"
      - type: body.contains
        not: true
        value: "<html"

models:
  path: /v1/models
  method: GET
  extract: ".data[].id"

augustus:
  generator: openai
  config_template:
    endpoint: "$TARGET/v1"
    model: "$MODEL"
    api_key: "not-needed"
    timeout: 180
